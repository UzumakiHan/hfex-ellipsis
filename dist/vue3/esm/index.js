import{openBlock as t,createElementBlock as e,normalizeStyle as s,createElementVNode as i,toDisplayString as o,renderSlot as l,createCommentVNode as n}from"vue";var h={name:"HfexEllipsis",props:{text:{type:String,default:"",required:!0},maxLines:{type:Number,default:3},width:{type:Number,default:100}},data(){return{expanded:!1,slotBoxWidth:0,showSlotNode:!1,offset:this.text.length,textBoxWidth:this.width}},computed:{boxStyle(){return this.width?{width:`${this.width}%`}:""},realText(){const t=this.offset!==this.text.length;let e=this.text;return t&&!this.expanded&&(e=`${this.text.slice(0,this.offset)}...`),e}},mounted(){const{len:t}=this.getLines();t>this.maxLines&&(this.showSlotNode=!0,this.$nextTick((()=>{this.slotBoxWidth=this.$refs.slotRef.clientWidth,this.textBoxWidth=this.$refs.textOverflow.clientWidth,this.calculateOffset(0,this.text.length)})))},methods:{getLines(){const t=this.$refs.overEllipsis.getClientRects();return{len:t.length,lastWidth:t[t.length-1].width}},isOverflow(){const{len:t,lastWidth:e}=this.getLines();if(t<this.maxLines)return!1;if(this.maxLines){const s=Boolean(t===this.maxLines&&e+this.slotBoxWidth>this.textBoxWidth);if(t>this.maxLines||s)return!0}return!1},calculateOffset(t,e){this.$nextTick((()=>{Math.abs(t-e)<=1||(this.isOverflow()?e=this.offset:t=this.offset,this.offset=Math.floor((t+e)/2),this.calculateOffset(t,e))}))},toggle(){this.expanded=!this.expanded}}};const d={key:0,ref:"slotRef",class:"slot-box"};!function(t,e){void 0===e&&(e={});var s=e.insertAt;if(t&&"undefined"!=typeof document){var i=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===s&&i.firstChild?i.insertBefore(o,i.firstChild):i.appendChild(o),o.styleSheet?o.styleSheet.cssText=t:o.appendChild(document.createTextNode(t))}}(".slot-box[data-v-21fec300] {\n  display: inline-block;\n}"),h.render=function(h,a,f,r,x,c){return t(),e("div",{ref:"textOverflow",class:"text-overflow",style:s(c.boxStyle)},[i("span",{ref:"overEllipsis"},o(c.realText),513),x.showSlotNode?(t(),e("span",d,[l(h.$slots,"default",{clickToggle:c.toggle,expanded:x.expanded})],512)):n("v-if",!0)],4)},h.__scopeId="data-v-21fec300",h.__file="src/vue/index.vue",h.install=t=>{t.component(h.name,h)};export{h as default};

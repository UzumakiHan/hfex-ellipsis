import{defineComponent as e,ref as t,computed as l,onMounted as n,nextTick as a,openBlock as s,createElementBlock as o,normalizeStyle as i,createElementVNode as d,toDisplayString as r,renderSlot as u,createCommentVNode as f}from"vue";var c=e({name:"HfexEllipsis",props:{text:{type:String,required:!0},maxLines:{type:Number,default:3},width:{type:Number,default:100}},setup(e){const s=t(!1),o=t(0),i=t(!1),d=t(),r=t(),u=t(),f=t(e.text.length),c=t(e.width),v=l((()=>e.width?{width:`${e.width}%`}:"")),x=l((()=>{const t=f.value!==e.text.length;let l=e.text;return t&&!s.value&&(l=`${e.text.slice(0,f.value)}...`),l})),h=()=>{const e=r.value.getClientRects();return{len:e.length,lastWidth:e[e.length-1].width}},p=()=>{const{len:t,lastWidth:l}=h();if(t<e.maxLines)return!1;if(e.maxLines){const n=Boolean(t===e.maxLines&&l+o.value>c.value);if(t>e.maxLines||n)return!0}return!1},m=(e,t)=>{a((()=>{Math.abs(e-t)<=1||(p()?t=f.value:e=f.value,f.value=Math.floor((e+t)/2),m(e,t))}))};return n((()=>{const{len:t}=h();t>e.maxLines&&(i.value=!0,a((()=>{o.value=u.value.clientWidth,c.value=d.value.clientWidth,m(0,e.text.length)})))})),{textOverflow:d,slotRef:u,showSlotNode:i,offset:f,expanded:s,slotBoxWidth:o,textBoxWidth:c,boxStyle:v,realText:x,overEllipsis:r,calculateOffset:m,isOverflow:p,getLines:h,toggle:()=>{s.value=!s.value}}}});const v={key:0,ref:"slotRef",class:"slot-box"};!function(e,t){void 0===t&&(t={});var l=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===l&&n.firstChild?n.insertBefore(a,n.firstChild):n.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}(".slot-box[data-v-21fec300] {\n  display: inline-block;\n}"),c.render=function(e,t,l,n,a,c){return s(),o("div",{ref:"textOverflow",class:"text-overflow",style:i(e.boxStyle)},[d("span",{ref:"overEllipsis"},r(e.realText),513),e.showSlotNode?(s(),o("span",v,[u(e.$slots,"default",{clickToggle:e.toggle,expanded:e.expanded})],512)):f("v-if",!0)],4)},c.__scopeId="data-v-21fec300",c.__file="src/vue/index.vue",c.install=e=>{e.component(c.name,c)};export{c as default};
